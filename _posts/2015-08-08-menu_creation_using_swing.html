---
layout: post
title:  "Menu creation using Swing"
date:   2015-07-29 14:40:28
categories: Java Swing Review
---

<br/>
<p>This review aims to introduce functional interface applied to a concrete application : creating menu with graphical API <a target="_blank" href="https://docs.oracle.com/javase/tutorial/uiswing/">Swing</a>.</p>
<br/>

<h3>Application controller</h3>
<br/>

<div class="container-fluid">
<div class="row">
<div class="col-md-7">

<br/>
<p>For this review purpose, we will consider a simple application that offers a traditional <tt>File</tt> menu, with three actions : <tt>Open</tt>, <tt>Save</tt> and <tt>Exit</tt>.</p>
<br/>
<p>With <a target="_blank" href="https://docs.oracle.com/javase/tutorial/uiswing/">Swing</a>, each menu item should be connected to the functional interface <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionListener.html">ActionListener</a>, in order to perform an associated action. Since method reference could be now interpreted as functional interface, we will consider the <tt>Controller</tt> interface which provides a functional method for each action it could handle.</p>

</div>
<div class="col-md-5">

<script src="https://gist.github.com/Faylixe/0e8a9f92d0791c3a7777.js"></script>

</div>
</div>
</div>

<h3>Menu builder</h3>

<div class="container-fluid">
<div class="row">
<div class="col-md-6">

<br/>
<p>To build our menu, we will first setup a dedicated class for building a <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenu.html">JMenu</a> entry, named <tt>MenuBuilder</tt>.</p>
<br/>
<p>The following snippet shows our class header. We also made our class implements <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html">Supplier</a> interface as it aims to provide a <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenu.html">JMenu</a>.</p>

</div>
<div class="col-md-6">

<div class="centered">
  <a href="/images/review/menu-creation-using-swing/menubuilder.png"><img src="/images/review/menu-creation-using-swing/menubuilder.png" class="img-responsive img-thumbnail" style="max-width: 300px;" /></a>
</div>

</div>
</div>
<div class="row">
<div class="col-md-11">

<br/>
<div class="centered">
  <script src="https://gist.github.com/Faylixe/b4bc013cb81cefeec83e.js"></script>
</div>
<br/>
<p>Now in order to fill our menu, we will add a method for creating a menu item instance using a given <tt>label</tt>, and <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionListener.html">ActionListener</a>, which will be added to the target <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenu.html">JMenu</a> :</p>
<br/>
<script src="https://gist.github.com/Faylixe/4ed4f4f776afb9734066.js"></script>
<br/>

</div>
</div>
</div>

<h3>Menu bar builder</h3>

<div class="container-fluid">
<div class="row">
<div class="col-md-6">

<br/>
<p>Finally, we need to setup a component which will be in charge of creating a <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenuBar.html">JMenuBar</a>, and will only contains the two following atttributes :</p>
<ul>
<li>Reference to our application controller (as we will use it to connect item to action).</li>
<li>Target <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenuBar.html">JMenuBar</a> instance that this builder will fill up.</li>
</ul>
<br/>
<div class="alert alert-info"><p>You can notice that the constructor is set as <tt>private</tt>, only a static factory method would be provided later.</p></div>
</div>
<div class="col-md-6">

<div class="centered">
  <a href="/images/review/menu-creation-using-swing/menubarbuilder.png"><img src="/images/review/menu-creation-using-swing/menubarbuilder.png" class="img-responsive img-thumbnail" style="max-width: 300px;" /></a>
</div>

</div>
</div>
<div class="row">
<div class="col-md-11">

<br/>
<p>Then creating a menu will be as simple as following, we only have to use the previously defined <tt>MenuBuilder</tt> class, with method reference from our <tt>Controller</tt> instance as <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionListener.html">ActionListener</a> for creating menu entry :</p>
<br/>
[java]/** Creates File menu and plug it to the target menu bar. **/
private void createFileMenu() {
   final MenuBuilder builder = new MenuBuilder(new JMenu("File"));
   builder.createItem("Open", controller::open);
   builder.createItem("Save", controller::save);
   builder.createItem("Exit", controller::exit);
   target.add(builder.get());
}[/java]
<br/>
<p>Last step, we have to define a static factory method for using our class which will prevent from misusage. Here we only have one menu, but you could add method as much as menu you have.</p>
<br/>
[java]
public static JMenuBar build(final Controller controller) {
    final MenuBuilder builder = new MenuBuilder(controller);
    builder.createFileMenu();
    return builder.get();
}[/java]

</div>
</div>
</div>

<h3>Bonus : Item delayed activation</h3>


<div class="container-fluid">
<div class="row">
<div class="col-md-11">
<br/>
<p>Our menu is working, but let's improve it. Imagine you want to set the <tt>Save</tt> item disabled until a file has been opened. To do so, we will use the method you probably have noticed while looking the UML class diagram for the <tt>MenuBuilder</tt> : <tt>createActivable(<a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>, <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionListener.html">ActionListener</a>)</tt>.</p>
<br/>
<p>This method creates a <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/javax/swing/JMenuItem.html">JMenuItem</a> by calling the <tt>createItem(<a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a>, <a target="_blank" href="http://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionListener.html">ActionListener</a>)</tt> method, and then returns a <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">Runnable</a> object :</p>
<br/>
[java]public Runnable createActivable(final String label, final ActionListener listener) {
    final JMenuItem item = createItem(label, listener);
    item.setEnabled(false);
    return () -> item.setEnabled(true);
}[/java]
<br/>
<p>As you can see, the returned <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">Runnable</a> instance is only enabling the associated menu item, and could then be used in order to activate the entry. To integrate this behavior for the <tt>Save</tt> item, we will update our <tt>Controller</tt> interface, and make it extends <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html">Consumer</a> for <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">Runnable</a> type :</p>
<br/>
[java]public interface Controller extends Consumer<Runnable>[/java]
<br/>
<p>And use the associated <tt><a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Consumer.html#accept-T-">accept(Runnable)</a></tt> method into the file menu creation : </p>
<br/>
[java]/** ... **/
controller.accept(builder.createItem("Save", controller::save));
/** ... **/[/java]
<br/>
<p>The <tt>Controller</tt> implementation will just have to store the given <a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html">Runnable</a> and call it during the <tt>open(<a target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/awt/event/ActionEvent.html">ActionEvent</a>)</tt> method.</p>
</div>
</div>
</div>

<h3>Download</h3>

<span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> <a target="_blank" href="/download/snippet/menu-creation-with-swing/Controller.java">Controller.java</a>
<span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> <a target="_blank" href="/download/snippet/menu-creation-with-swing/MenuBuilder.java">MenuBuilder.java</a>
<span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span> <a target="_blank" href="/download/snippet/menu-creation-with-swing/MenuBarBuilder.java">MenuBarBuilder.java</a>
